# Домашнее задание №39

> Всем привет! Это домашнее задание - это смесь последних двух занятий. 
> По сути итог этого домашнего занятия - это регистрация и авторизация вместе с ролевой моделью 
> на JWT-токенах.

## Задача №1
В качестве первого задания вам необходимо загрузить код, который мы делали на прошлом занятии (занятие №38). 
Что там должно быть? 
1. Контроллер авторизации - возвращается токен 
2. Контроллер регистрации - сохраняется новый пользователь и возвращается токен
3. Тестовый контроллер, внутри которого проверяется, что пользователь авторизован

## Задача №2
Усложнение задачи. В предыдущем шаге мы просто генерировали токен, однако внутри него нет никакой информации о пользователе. 
Ваша задача на этом этапе - добавить в `Claims` информацию об `id`, `email` и `name/surname` пользователя. 

В тестовый контроллер надо добавить функционал парсинга токена, 
чтобы для авторизованных пользователей получать данные из токена (без запроса в БД!). 

## Задача №3 (hard!)
Теперь надо добавить ролевую модель в ваше мини-приложения. На данном этапе у нас есть только таблица `User`. 
Создайте новую таблицу - `Role`, где будет храниться список доступных ролей. Вы можете придумать любые роли, 
однако если фантазировать лень, то вот базовый список:
1. `USER`
2. `ADMIN`
3. `MODERATOR`
4. `INVESTOR`

Роли придуманные и никакой смысл особо за собой не несут, однако важно, что пользователь может быть одновременно
и обычным пользователем, и администратором, и модератором! Именно поэтому связь между `User` и `Role` должна быть 
`many-to-many` с помощью вспомогательной таблицы. 

> В качестве упрощения можете реализовать вариант, что у одного пользователя только одна роль, тогда связь будет намного проще!

После этого вам необходимо добавлять роли пользователя в токен, который генерируется при авторизации/регистрации. 
Для проверки создайте несколько контроллеров, куда будет доступ только у определенных ролей 
(например, у меня четыре роли - значит, должно быть четыре контроллера для проверки ролей).

В итоге должно получится, что при авторизации/регистрации пользователь должен получать токен, в котором зашифрована вся информация о нем 
и мы можем парсить его токен в тестовых контроллерах, чтобы регулировать доступ для определенных ролей. 